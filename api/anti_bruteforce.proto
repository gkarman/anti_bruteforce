syntax = "proto3";


package anti_bruteforce;

option go_package = "github.com/gkarman/anti_bruteforce/api/pb;pb";

service AntiBruteforceService {
  rpc IsCanLogin (IsCanLoginRequest) returns (IsCanLoginResponse);
  rpc ClearBucket (ClearBucketRequest) returns (ClearBucketResponse);
  rpc AddCIDRToWhiteList (AddCIDRToWhiteListRequest) returns (AddCIDRToWhiteListResponse);
  rpc AddCIDRToBlackList (AddCIDRToBlackListRequest) returns (AddCIDRToBlackListResponse);
  rpc DeleteCIDRFromBlackList (DeleteCIDRFromBlackListRequest) returns (DeleteCIDRFromBlackListResponse);
  rpc DeleteCIDRFromWhiteList (DeleteCIDRFromWhiteListRequest) returns (DeleteCIDRFromWhiteListResponse);
}

message IsCanLoginRequest {
  string login = 1;
  string password = 2;
  string ip = 3;
}

message IsCanLoginResponse {
  bool ok = 1;
}

message ClearBucketRequest {
  string login = 1;
  string ip = 2;
}

message ClearBucketResponse {
  bool ok = 1;
  string message = 2;
}

message AddCIDRToBlackListRequest {
  string cidr = 1;
}

message AddCIDRToBlackListResponse {
  bool ok = 1;
  string message = 2;
}

message DeleteCIDRFromBlackListRequest {
  string cidr = 1;
}

message DeleteCIDRFromBlackListResponse {
  bool ok = 1;
  string message = 2;
}

message AddCIDRToWhiteListRequest {
  string cidr = 1;
}

message AddCIDRToWhiteListResponse {
  bool ok = 1;
  string message = 2;
}

message DeleteCIDRFromWhiteListRequest {
  string cidr = 1;
}

message DeleteCIDRFromWhiteListResponse {
  bool ok = 1;
  string message = 2;
}

